{% extends 'cart/header.html' %}
{% load static %}
{% block title %}Home | Cart{% endblock %}
{% block body %}
{% endblock %}
{% block content %}
<div class="container-fluid">
    <div style="margin-left: -15px; margin-right: -15px; background-color: #112222;">
        <div id="carouselExampleFade" class="carousel container-fluid slide carousel-fade" data-bs-ride="carousel"
            style="font-family: 'Overlock', cursive;">
            <div class="carousel-indicators my-1">
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
                    aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                    aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                    aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item drk active" data-bs-interval="2000">
                    <img src="{{data1.ban1Image.stringValue}}" class="d-block w-100" style="height: 50vh; width: 100vw;"
                        alt="...">
                    <div class="carousel-caption d-md-block my-2">
                        <h1 style="cursor: pointer;" class="display-5 ">{{data1.ShopName.stringValue}}</h1>
                        <h4 style="cursor: pointer;"><i>{{data1.desc.stringValue}}</i></h4><br>
                        <a href="{{data1.fb.stringValue}}" class="btn btn-light mx-2"><i class="fab fa-facebook fa-2x" style="color: #0d6efd;"></i></a>
                        <a href="https://api.whatsapp.com/send/?phone=%2B91{{data1.wp.stringValue}}&text&app_absent=0" class="btn btn-light mx-2"><i class="fab fa-whatsapp fa-2x" style="color: #198754;"></i></a>
                        <a href="{{data1.insta.stringValue}}" class="btn btn-light mx-2"><i class="fab fa-instagram fa-2x" style="color: #d63384;"></i></a>
                    </div>
                </div>
                <div class="carousel-item drk" data-bs-interval="2000">
                    <img src="{{data1.ban2Image.stringValue}}" class="d-block w-100" style="height: 50vh; width: 100vw;"
                        alt="...">
                    <div class="carousel-caption d-md-block my-2">
                        <h1 style="cursor: pointer;" class="display-5 ">{{data1.ShopName.stringValue}}</h1>
                        <h4 style="cursor: pointer;" class="fw-light"><i>{{data1.desc.stringValue}}</i></h4><br>
                        <a href="{{data1.fb.stringValue}}" class="btn btn-light mx-2"><i class="fab fa-facebook fa-2x" style="color: #0d6efd;"></i></a>
                        <a href="https://api.whatsapp.com/send/?phone=%2B91{{data1.wp.stringValue}}&text&app_absent=0" class="btn btn-light mx-2"><i class="fab fa-whatsapp fa-2x" style="color: #198754;"></i></a>
                        <a href="{{data1.insta.stringValue}}" class="btn btn-light mx-2"><i class="fab fa-instagram fa-2x" style="color: #d63384;"></i></a>
                    </div>
                </div>
                <div class="carousel-item drk" data-bs-interval="2000">
                    <img src="{{data1.ban3Image.stringValue}}" class="d-block w-100" style="height: 50vh; width: 100vw;"
                        alt="...">
                    <div class="carousel-caption d-md-block my-2">
                        <h1 style="cursor: pointer;" class="display-5 ">{{data1.ShopName.stringValue}}</h1>
                        <h4 style="cursor: pointer;" class="fw-light"><i>{{data1.desc.stringValue}}</i></h4><br>
                        <a href="{{data1.fb.stringValue}}" class="btn btn-light mx-2"><i class="fab fa-facebook fa-2x" style="color: #0d6efd;"></i></a>
                        <a href="https://api.whatsapp.com/send/?phone=%2B91{{data1.wp.stringValue}}&text&app_absent=0" class="btn btn-light mx-2"><i class="fab fa-whatsapp fa-2x" style="color: #198754;"></i></a>
                        <a href="{{data1.insta.stringValue}}" class="btn btn-light mx-2"><i class="fab fa-instagram fa-2x" style="color: #d63384;"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row d-flex justify-content-center">
        {% for c in cats %}
        <h1 class="display-6 p-2 my-2 text-center text-warning" style="background-color: #112222;">{{c}}</h1>
        {% for i in data %}
        {% if i.fields.Product_Category.stringValue == c %}
        <div class="row m-3 p-0 bg-white shadow-lg" style="width: 400px; height: 200px; cursor: pointer;">
            <div class="col float-left p-0">
                <img style="height: 200px; width: 200px;" id="imgprC{{i.fields.Product_Id.stringValue}}"
                    src={{i.fields.Product_ImageUri.stringValue}}>
            </div>
            <div style="width:auto;" class="col px-3 py-2">
                <h6 class="card-title" id="nameprC{{i.fields.Product_Id.stringValue}}">
                    {{i.fields.Product_Name.stringValue}}</h6>
                <p class="fs-6"><small>
                        Rs. <span
                            id="priceprC{{i.fields.Product_Id.stringValue}}">{{i.fields.Product_Price.stringValue}}</span>
                        | <span> {{i.fields.Product_Discount.stringValue}}% off</span><br>
                        <span>{{i.fields.Product_Status.stringValue}}</span><br>
                        <span class="d-inline-block text-truncate"
                            style="max-width: 150px;">{{i.fields.Product_Desc.stringValue}}</span>
                    </small></p>
                <span id="divprC{{i.fields.Product_Id.stringValue}}" class="divpr d-flex justify-content-between mt-2"
                    style="display: block; width: 100%;">
                    <button id="prC{{i.fields.Product_Id.stringValue}}" class="btn btn-dark btn-sm mt-1 addToCart"
                        style="display: block; width: 100%;">Add to Cart</button>
                </span>
                <button id="prB{{i.fields.Product_Id.stringValue}}" class="btn btn-warning btn-sm mt-2"
                    style="display: block; width: 100%;">Buy Now</button>
            </div>
        </div>
        {% endif %}
        {% endfor %}
        {% endfor %}
    </div>
</div>
{% endblock %}
{% block footer %}
<section class="d-flex justify-content-lg-between p-4 border-bottom">
    <!-- Left -->
    <div class="me-5 d-none d-lg-block">
        <span class="fst-italic">Get connected with us on social networks:</span>
    </div>
    <!-- Left -->

    <!-- Right -->
    <div>
        <a href="" class="me-4 text-reset">
            <i class="fab fa-facebook-f"></i>
        </a>
        <a href="" class="me-4 text-reset">
            <i class="fab fa-twitter"></i>
        </a>
        <a href="" class="me-4 text-reset">
            <i class="fab fa-google"></i>
        </a>
        <a href="" class="me-4 text-reset">
            <i class="fab fa-instagram"></i>
        </a>
        <a href="" class="me-4 text-reset">
            <i class="fab fa-linkedin"></i>
        </a>
        <a href="" class="me-4 text-reset">
            <i class="fab fa-github"></i>
        </a>
    </div>
    <!-- Right -->
</section>
<!-- Section: Social media -->
<!-- Section: Links  -->
<section class="text-muted">
    <div class="container text-md-start mt-5">
        <!-- Grid row -->
        <div class="row mt-3">
            <!-- Grid column -->
            <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
                <!-- Content -->
                <h6 class="text-uppercase fw-bold mb-4">
                    <!-- <i class="fas fa-gem me-3"></i> -->
                    <img src="{% static 'cart/titlelogo.png' %}" alt="DS" height="30px" width="30px"
                        style="margin-right:10px;"><span>Droppers Service</span>
                </h6>
                <p style="text-align:justify">
                    Send packages across the city and get everything from food, groceries, medicines and pet
                    supplies delivered right
                    to your doorstep. From any store to your door, just make a list and weâ€™ll make it disappear.
                    Just use Droppers Services!
                </p>
                <br>
                <h6 class="text-uppercase fw-bold mb-4">
                    SERVICEABLE CITIES
                </h6>
                <p>
                    <a href="#!" class="text-reset">Bhilai</a> | <a href="#!" class="text-reset">Durg</a>
                </p>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
                <!-- Links -->
                <h6 class="text-uppercase fw-bold mb-4">
                    Droppers
                </h6>
                <p class="mb-2">
                    <a href="{% url 'About' %}" class="text-reset">Terms & Conditions</a>
                </p>
                <p class="mb-2">
                    <a href="{% url 'About' %}" class="text-reset">Service Offered</a>
                </p>
                <p class="mb-2">
                    <a href="{% url 'About' %}" class="text-reset">Refund/Cancellation</a>
                </p>
                <p class="mb-2">
                    <a href="{% url 'About' %}" class="text-reset">Privacy Policy</a>
                </p>
            </div>
            <!-- Grid column -->


            <!-- Grid column -->
            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
                <!-- Links -->
                <h6 class="text-uppercase fw-bold mb-4">
                    Contact
                </h6>
                <p class="mb-2" style="cursor: pointer;"><i class="fas fa-envelope me-2 text-warning"></i> {{data1.email.stringValue}}</p>
                <p class="mb-2" style="cursor: pointer;"><i class="fas fa-phone me-2 text-warning"></i> {{data1.phone.stringValue}}</p>
                <p class="mb-2" style="cursor: pointer;"><i class="fas fa-user-tie me-2 text-warning"></i> Mon-Sun : 9.00am to 10:30pm</p>
                <p class="mb-2" style="cursor: pointer;"><i class="fas fa-home me-2 text-warning"></i> {{data1.address.stringValue}}</p>
            </div>
            <!-- Grid column -->


            <!-- Grid column -->
            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
                <img src="{% static 'cart/Mob.png' %}" height="250px" id="mobimg"
                    style="transform: rotate(20deg); margin-top: -20px; margin-left:-10px;" alt="">
                <p class="text-center fst-italic text-warning">Download the Droppers mobile app.</p>
                <a href="#!"><img src="{% static 'cart/gplay.png' %}" alt=""></a>
            </div>
            <!-- Grid column -->

        </div>
        <!-- Grid row -->
    </div>
</section>
<!-- Section: Links  -->
{% endblock %}
{% block js %}
<script>

    document.getElementById("IndexPage").classList.add("active");

    localStorage.setItem('homeLink', window.location.pathname);

    function myFunction() {
        location.href = localStorage.getItem('homeLink');
    }

    if (localStorage.getItem('cart') == null) {
        var cart = {};
        document.getElementById('cartBadge').innerHTML = Object.keys(cart).length;
    }
    else {
        cart = JSON.parse(localStorage.getItem('cart'));
        document.getElementById('cartBadge').innerHTML = Object.keys(cart).length;
        updateCart(cart);
    }

    $('.divpr').on('click', 'button.addToCart', function () {
        var idstr = this.id.toString();
        console.log(cart)
        if (cart[idstr] != undefined) {
            qty = cart[idstr][0] + 1;
        }
        else {
            qty = 1;
            id = idstr.slice(3,);
            img = document.getElementById('img' + idstr).src.trim();
            name = document.getElementById('name' + idstr).innerHTML.trim();
            price = document.getElementById('price' + idstr).innerHTML.trim();
            cart[idstr] = [qty, name, price, id, img];
        }
        updateCart(cart);
    });

    function updateCart(cart) {
        var sum = 0;
        for (var item in cart) {
            sum = sum + cart[item][0];
            document.getElementById("div" + item).innerHTML = "<span class='my-auto'><button id='minus" + item + "' class='btn btn-dark btn-sm mt-1 minus'>-</button> <span class='btn btn-light btn-sm mt-1' id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-dark btn-sm mt-1 plus'> + </button></span> <span><a href='{% url 'ShowCart' %}' class='btn btn-dark btn-sm mt-1 plus'><i class='fas fa-shopping-cart'></i>  Cart</a></span>";
        }
        localStorage.setItem('cart', JSON.stringify(cart));
        document.getElementById('cartBadge').innerHTML = sum;
    }

    $('.divpr').on("click", "button.minus", function () {
        a = this.id.slice(5,);
        cart[a][0] = cart[a][0] - 1;
        cart[a][0] = Math.max(0, cart[a][0]);
        document.getElementById('val' + a).innerHTML = cart[a][0];
        if (cart[a][0] == 0) {
            delete cart[a];
            document.getElementById('div' + a).innerHTML = '<button id="' + a + '" class="btn btn-dark btn-sm mt-1 addToCart" style="display: block; width: 100%;">Add To Cart</button>'
            updateCart(cart);
        }
        updateCart(cart);
    });

    $('.divpr').on("click", "button.plus", function () {
        a = this.id.slice(4,);
        cart[a][0] = cart[a][0] + 1;
        document.getElementById('val' + a).innerHTML = cart[a][0];
        updateCart(cart);
    });

    function clearCart() {
        cart = JSON.parse(localStorage.getItem('cart'));
        for (var item in cart) {
            document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-dark btn-sm mt-1 addToCart" style="display: block; width: 100%;">Add To Cart</button>'
        }
        localStorage.clear();
        cart = {};
        updateCart(cart);
    }

</script>
{% endblock js %}